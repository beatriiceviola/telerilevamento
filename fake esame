#Richiamo i pacchetti che andrò ad utilizzare
library(terra) #per la funzione rast
library(ggplot2) #per costruire grafici
library(viridis) #per avere una colorRampoPalette adatta ai daltonici
library(imageRy) #per la funzione im.classify()
library(patchwork) #per unire i grafici

#Il progetto riguarda una zona di riforestazione nei dintorni di Miguel Pereira in Brasile
#Dopo gli incendi del 2014 sono stati ripiantati più di 600 mila alberi tra il 2018 e il 2021
#Osserviamo gli effetti di questa riforestazione
#Le immagini sono state prese da Copernicus Browser
#Iniziamo cambiando la nostra work directoy da cui R prenderà i dati che ci servono
setwd("/Users/macbookairair/Downloads/Progetto R")

#Ora andiamo a prendere dalla nostra cartella l'immagine che ci serve
#Le immagini sono state fatte da Sentinel-2
#Le bande sono già decise
#Prima importiamo le immagini con colori naturali true colors=tc
#banda 1 = R = red
#banda 2 = G = green
#banda 3 = B = blue
suppressWarnings({
tc2017 <- rast("tcse17.jpg")
})
suppressWarnings({
tc2023 <- rast("tcag23.jpg")
})



#CLASSIFICAZIONE 
#Classifichiamo con 2 cluster le immagini
#2017
class17 <- im.classify(tc2017, num_clusters=2)
class.names <- c("suolo nudo", "foresta")
#Plottiamo dando un titolo all'immagine e un nome all classi
plot(class17, main= "Classificazione 2017", type="classes", levels= class.names)

#2023
class23 <- im.classify(tc2023, num_clusters=2)
class.names <- c("foresta", "suolo nudo")
plot(class23, main= "Classificazione 2023", type="classes", levels=class.names)

#Calcoliamo la frequenza dei pixel presenti in una classe
#e quella dei pixel presenti nell'altra
#2017
freq17 <- freq(class17)
freq17
#Calcoliamo il totale dei pixel
tot17 <- ncell (class17)
tot17
#Proporzione
prop17 = freq17/tot17
prop17
#Percentuale 
#Foresta = 51%
#Suolo nudo= 49%
perc17 = prop17*100
perc17
